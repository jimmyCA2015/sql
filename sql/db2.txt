SELECT a.DETAIL_LINE_ID,MIN(TRACE_NO) AS "REFERENCE",min(BILL_DATE) AS "BILL_DATE",min(INVOICE_TYPE) AS "INVOICE_TYPE",min(CUSTOMER) AS "CUSTOMER",min(SERVICE_LEVEL) AS "SERVICE_LEVEL",min(BILL_TO) AS "BILL_TO",min(BILL_TO_NAME) AS "BILL_TO_NAME",min(BILL_NUMBER)
AS "BILL_NUMBER",min(CURRENT_STATUS) AS "STATUS", MIN(PALLETS) AS "PALLETS",min(AS_WEIGHT) AS "AS_WEIGHT",min(CUBE_WEIGHT) AS "CUBE_WEIGHT",min(WEIGHT) AS "WEIGHT",
min(pick_up_by) AS "ACTUAL_PICKUP",min(PICKUP_AT_CONTACT) AS
"PICKUP_AT_CONTACT",min(PICKUP_AT_NAME) AS "PICKUP_AT_NAME",min(PICKUP_AT_ADDR1) AS "PICKUP_AT_ADDR1",min(PICKUP_AT_ADDR2) AS "PICKUP_AT_ADDR2",min(PICKUP_AT_CITY) AS "PICKUP_AT_CITY",min(PICKUP_AT_PROV) AS "PICKUP_AT_PROV",
min(PICKUP_AT_UNIT) AS "PICKUP_AT_UNIT",min(PICKUP_AT_ZONE) AS "PICKUP_AT_ZONE",min(PICKUP_AT_PC) AS "PICKUP_AT_POSTALCODE",min(deliver_by) AS "ACTUAL_DELIVERY",min(DESTCONTACT) AS "DESTCONTACT",min(DESTINATION) AS "DESTINATION",min(DESTNAME) AS "DESTNAME",min(DESTADDR1) AS "DESTADDR1",min(DESTADDR2) AS "DESTADDR2",min(DESTCITY)
AS "DESTCITY",min(DESTPROV) AS "DESTPROV", min(DESTPC) AS "DESTINATION POSTAL CODE",
min(DESTUNIT) AS "DESTUNIT",min(DEST_TIMEZONE) AS"DEST_TIMEZONE",min(PIECES) AS "PIECES",min(CHARGES) AS "CHARGES",min(CHARGE_TYPE) AS "CHARGE_TYPE",min(SUPPLIER_CHARGES) AS "SUPPLIER_CHARGES",min(FUEL_WARMUPS) AS "FUEL_WARMUPS",min(NO_CHARGE) AS "NO_CHARGE",min(XCHARGES) AS "XCHARGES",MAX(CASE WHEN a.ACODE_ID='FSC-LTL' then a.charge_amount ELSE 0  END) AS "FSC-LTL-FUELSURCHARGE",
MAX(CASE WHEN a.ACODE_ID='TGPICK' then a.charge_amount ELSE 0  END) AS "TGPICK-TAILGATE",MAX(CASE WHEN a.ACODE_ID='FSC-LTL-IN' then a.charge_amount ELSE 0  END) AS "FSC-LTL-IN-FUELSURCHARGE",min(TAX_1) AS "TAX_1",min(TAX_2) AS "TAX_2",min(TOTAL_CHARGES) AS "TOTAL_CHARGES"
FROM TMWIN.TLORDER b INNER JOIN TMWIN.ACHARGE_TLORDER a on b.detail_line_id=a.detail_line_id  group by a.detail_line_id


SELECT a.DETAIL_LINE_ID,a.ACODE_ID,CHARGE_AMOUNT,NOTATION,SHORT_DESC FROM
TMWIN.ACHARGE_TLORDER a  LEFT OUTER JOIN TMWIN.ACHARGE_CODE b ON a.ACODE_ID=b.ACODE_ID order by a.DETAIL_LINE_ID


SELECT a.DETAIL_LINE_ID,CASE WHEN a.ACODE_ID='FSC-LTL' then charge_amount ELSE 0  END AS 'FSC-LTL',CASE WHEN a.ACODE_ID='FSC-LTL' then charge_amount ELSE 0  END AS 'FSC-LTL',CASE WHEN a.ACODE_ID='TGPICK' then charge_amount ELSE 0  END AS 'TGPICK',CASE WHEN a.ACODE_ID='FSC-LTL-IN' then charge_amount ELSE 0  END AS 'FSC-LTL-IN' FROM
TMWIN.ACHARGE_TLORDER a  LEFT OUTER JOIN TMWIN.ACHARGE_CODE b ON a.ACODE_ID=b.ACODE_ID GROUP by a.DETAIL_LINE_ID


SELECT a.DETAIL_LINE_ID,a.acode_id,CASE WHEN each(a.ACODE_ID)='FSC-LTL' then max(charge_amount) ELSE 0  END AS "FSC-LTL",CASE WHEN each(a.ACODE_ID)='TGPICK' then max(charge_amount) ELSE 0  END AS "TGPICK",CASE WHEN each(a.ACODE_ID)='FSC-LTL-IN' then max(charge_amount) ELSE 0  END AS "FSC-LTL-IN" FROM
TMWIN.ACHARGE_TLORDER a  LEFT OUTER JOIN TMWIN.ACHARGE_CODE b ON a.ACODE_ID=b.ACODE_ID  group by a.detail_line_id

SELECT a.DETAIL_LINE_ID,MAX(CASE WHEN a.ACODE_ID='FSC-LTL' then a.charge_amount ELSE 0  END) AS "FSC-LTL",
MAX(CASE WHEN a.ACODE_ID='TGPICK' then a.charge_amount ELSE 0  END) AS "TGPICK",MAX(CASE WHEN a.ACODE_ID='FSC-LTL-IN' then a.charge_amount ELSE 0  END) AS "FSC-LTL-IN" FROM
TMWIN.ACHARGE_TLORDER a  LEFT OUTER JOIN TMWIN.ACHARGE_CODE b ON a.ACODE_ID=b.ACODE_ID  group by a.detail_line_id;



SELECT a.DETAIL_LINE_ID,MAX(CASE WHEN a.ACODE_ID='FSC-LTL' then a.charge_amount ELSE 0  END) AS "FSC-LTL-FUELSURCHARGE",
MAX(CASE WHEN a.ACODE_ID='TGPICK' then a.charge_amount ELSE 0  END) AS "TGPICK-TAILGATE",MAX(CASE WHEN a.ACODE_ID='FSC-LTL-IN' then a.charge_amount ELSE 0  END) AS "FSC-LTL-IN-FUELSURCHARGE" FROM
TMWIN.ACHARGE_TLORDER a  group by a.detail_line_id;


SELECT a.DETAIL_LINE_ID,MAX(CASE WHEN a.ACODE_ID='FSC-LTL' then a.charge_amount ELSE 0  END) AS "FSC-LTL-FUELSURCHARGE",
MAX(CASE WHEN a.ACODE_ID='TGPICK' then a.charge_amount ELSE 0  END) AS "TGPICK-TAILGATE",MAX(CASE WHEN a.ACODE_ID='FSC-LTL-IN' then a.charge_amount ELSE 0  END) AS "FSC-LTL-IN-FUELSURCHARGE"
FROM TMWIN.TLORDER b INNER JOIN TMWIN.ACHARGE_TLORDER a on b.detail_line_id=a.detail_line_id  group by a.detail_line_id


CREATE OR REPLACE PROCEDURE ssrs (IN in_DIVISION_NAME VARCHAR(200),IN IN_NULL VARCHAR(200))
	DYNAMIC RESULT SETS 1
	LANGUAGE SQL
P1: BEGIN
	-- Declare cursor
	DECLARE STMT VARCHAR(120);
	DECLARE cursor1 CURSOR WITH RETURN for  
	SELECT ACTNO AS "WOW",CASE WHEN ORD.ACTDESC=in_DIVISION_NAME THEN 'Invoiced' END AS "WOW2" FROM JLIN.ACT ORD;	
	IF(IN_NULL ='WOW')
	THEN
	 OPEN cursor1;
	 END IF;
	 
END P1



CREATE OR REPLACE PROCEDURE SSRS ()
	DYNAMIC RESULT SETS 1
P1: BEGIN
	-- Declare cursor
	DECLARE cursor1 CURSOR WITH RETURN for
	SELECT a.DETAIL_LINE_ID,MIN(TRACE_NO) AS "REFERENCE",min(created_time)AS "Order Time",min(BILL_DATE) AS "BILL_DATE",min(INVOICE_TYPE) AS "INVOICE_TYPE",min(CUSTOMER) AS "CUSTOMER",min(SERVICE_LEVEL) AS "SERVICE_LEVEL",min(b.BILL_TO_CODE) AS "BILL_TO_CODE",min(BILL_TO) AS "BILL_TO",min(BILL_TO_NAME) AS "BILL_TO_NAME",min(BILL_NUMBER)
AS "BILL_NUMBER",min(CURRENT_STATUS) AS "STATUS", MIN(PALLETS) AS "PALLETS",min(AS_WEIGHT) AS "AS_WEIGHT",min(CUBE_WEIGHT) AS "CUBE_WEIGHT",min(WEIGHT) AS "WEIGHT",
min(pick_up_by) AS "ACTUAL_PICKUP",min(PICKUP_AT_CONTACT) AS
"PICKUP_AT_CONTACT",min(PICKUP_AT_NAME) AS "PICKUP_AT_NAME",min(PICKUP_AT_ADDR1) AS "PICKUP_AT_ADDR1",min(PICKUP_AT_ADDR2) AS "PICKUP_AT_ADDR2",min(PICKUP_AT_CITY) AS "PICKUP_AT_CITY",min(PICKUP_AT_PROV) AS "PICKUP_AT_PROV",
min(PICKUP_AT_UNIT) AS "PICKUP_AT_UNIT",min(PICKUP_AT_ZONE) AS "PICKUP_AT_ZONE",min(PICKUP_AT_PC) AS "PICKUP_AT_POSTALCODE",min(deliver_by) AS "ACTUAL_DELIVERY",min(DESTCONTACT) AS "DESTCONTACT",min(DESTINATION) AS "DESTINATION",min(DESTNAME) AS "DESTNAME",min(DESTADDR1) AS "DESTADDR1",min(DESTADDR2) AS "DESTADDR2",min(DESTCITY)
AS "DESTCITY",min(DESTPROV) AS "DESTPROV", min(DESTPC) AS "DESTINATION POSTAL CODE",
min(DESTUNIT) AS "DESTUNIT",min(DEST_TIMEZONE) AS"DEST_TIMEZONE",min(PIECES) AS "PIECES",min(CHARGES) AS "CHARGES",min(CHARGE_TYPE) AS "CHARGE_TYPE",min(SUPPLIER_CHARGES) AS "SUPPLIER_CHARGES",min(FUEL_WARMUPS) AS "FUEL_WARMUPS",min(NO_CHARGE) AS "NO_CHARGE",min(XCHARGES) AS "XCHARGES",MAX(CASE WHEN a.ACODE_ID='FSC-LTL' then a.charge_amount ELSE 0  END) AS "FSC-LTL-FUELSURCHARGE",
MAX(CASE WHEN a.ACODE_ID='TGPICK' then a.charge_amount ELSE 0  END) AS "TGPICK-TAILGATE",MAX(CASE WHEN a.ACODE_ID='FSC-LTL-IN' then a.charge_amount ELSE 0  END) AS "FSC-LTL-IN-FUELSURCHARGE",min(TAX_1) AS "TAX_1",min(TAX_2) AS "TAX_2",min(TOTAL_CHARGES) AS "TOTAL_CHARGES"
FROM TMWIN.TLORDER b INNER JOIN TMWIN.ACHARGE_TLORDER a on b.detail_line_id=a.detail_line_id  group by a.detail_line_id;


OPEN cursor1;

END P1



set schema='TMWIN';
CREATE TABLE TMWIN."EDIUsers" ( "UserNo" INTEGER NOT NULL, "MasterAccountID" INTEGER NOT NULL, "UserID" VARCHAR(15 OCTETS) NOT NULL, "UserPwd" VARCHAR(15 OCTETS), "UserFirstName" VARCHAR(50 OCTETS), "UserLastName" VARCHAR(50 OCTETS), "UserEmail" VARCHAR(100 OCTETS), "ViewOrders" SMALLINT, "ViewPrices" SMALLINT, "ViewPOD" SMALLINT, "ViewInvoices" SMALLINT, "ViewReports" SMALLINT, "View3rdParty" SMALLINT, "AnonLogin" VARCHAR(20 OCTETS), "CreatedDate" TIMESTAMP(3),PRIMARY KEY ( "UserNo" ) )


CREATE TABLE TMWIN."EDIUserAccessRogue" ( "UserNo" INTEGER NOT NULL, "SubAccountID" INTEGER NOT NULL,"UFOSAccount"  CHAR(6 OCTETS))